<h2 align="center">Bespokefit_smee</h2>

<p align="center">
  <a href="https://github.com/fjclark/bespokefit_smee/actions/workflows/ci.yaml">
    <img src="https://github.com/fjclark/bespokefit_smee/actions/workflows/ci.yaml/badge.svg" alt="CI" />
  </a>
  <a href="https://codecov.io/gh/fjclark/bespokefit_smee" >
    <img src="https://codecov.io/gh/fjclark/bespokefit_smee/graph/badge.svg?token=IBZ2H0NL58"/>
  </a>
  <a href="https://opensource.org/licenses/MIT">
    <img alt="license" src="https://img.shields.io/badge/License-MIT-yellow.svg" />
  </a>
  <a href="https://github.com/astral-sh/ruff">
    <img alt="Ruff" src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json" />
  </a>
  <a href="https://mypy-lang.org/">
    <img alt="Checked with mypy" src="https://www.mypy-lang.org/static/mypy_badge.svg" />
  </a>
</p>

---

Generate a Bespoke Force-Field Parametrization Quickly and Reliably. Developed in the [Cole Group](https://blogs.ncl.ac.uk/danielcole/about-us/) at Newcastle University. Please see the [**documentation**](https://fjclark.github.io/bespokefit_smee/latest/).

***Warning**: This code is experimental and under active development. It is not guaranteed to provide correct results,
the documentation and testing is incomplete, and the API may change without notice.*

## What is Bespokefit_smee?

Bespokefit_smee is a Force-Field parametrization tool. For a given molecule, it will generate a data set of conformers using machine learning models in [OpenMM-ML](https://github.com/openmm/openmm-ml) simulations. This dataset is used to optimise the force field parameters.

## Installation

Ensuring that you have mamba installed, run:
```bash
git clone https://github.com/fjclark/bespokefit_smee.git
cd bespokefit_smee
make install
```

## Usage

Run with command line arguments:
```bash
bespokefit_smee train --smiles "CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2"
```

Sensible defaults have been set, but all available options can be viewed with:
```bash
bespokefit_smee train --help
```

Analyse with:
```bash
bespokefit_smee analyse training_config.yaml # This will have been generated by the training command
```

Run from a yaml file:
```bash
bespokefit_smee write-default-yaml default.yaml
# Modify the yaml to set the desired smiles
bespokefit_smee train-from-yaml default.yaml
```

For more details on the theory and implementation, please see the [documentation](https://fjclark.github.io/bespokefit_smee/latest/).

## Copyright

Copyright (c) 2025, Thomas James Pope, Newcastle University, UK

Copyright (c) 2025, Finlay Clark, Newcastle University, UK

## Acknowledgements

All early development was completed by Thomas James Pope. Many ideas taken from Simon Boothroyd's super helpful [python-template](https://github.com/SimonBoothroyd/python-template).
